# Database 응용[2025-03-05]

## 새로 배운 내용
### 1. Index

#### 정의

Index는 데이터베이스에서 **테이블의 데이터 조회 속도를 높여주는 자료구조**다.

<br/>

인덱스는 크게 두 가지로 분류된다.

- **클러스터형 인덱스**: 데이터 자체(행)가 인덱스 순서대로 "**물리적으로**" 정렬되어 저장된다.
- **비클러스터형 인덱스**: 데이터와 인덱스가 물리적으로 분리되어, 인덱스 페이지의 포인터를 통해 원본 데이터를 참조한다.
  - `B-tree` 또는 `B+tree`와 같은 구조로 구현되며, 각 인덱스 페이지는 트리의 노드처럼 동작한다.

<br/>

#### 사용하는 이유

인덱스를 사용해 데이터를 정렬하면 특정 데이터를 매우 빠르게 찾을 수 있어 검색 효율이 크게 향상된다.

- 클러스터형과 비클러스터형 인덱스 모두 인덱스가 정렬되어, 인덱스를 활용해 빠르게 정렬된 결과를 출력할 수 있다.

<br/>

#### 동작방식

- 인덱스는 특정 컬럼(들)에 대해 생성된다.
  - 높은 `Cardinality`와 1에 가까운 `Selectivity`를 가지는 즉, "**고유값**"이 많은 컬럼을 선택한다.

- 데이터가 추가, 삭제, 수정될 때마다 인덱스 또한 업데이트된다.

  📍 따라서, 데이터 변경 작업이 발생하면 DML 및 DDL 작업 성능 저하가 나타날 수 있다.

<br/><br/>

### 2. Transaction
#### 정의

트랜잭션은 작업 하나를 수행하는 데 필요한 데이터베이스의 **연산들을 모아놓은 것**으로, 데이터베이스의 논리적인 작업의 단위다.

<br/>

##### 🔹 트랜잭션의 상태

![트랜잭션의 상태](https://velog.velcdn.com/images/deeptree97/post/ba98cebc-658f-4162-95c8-8ad70a27e0cf/image.jpg)

출처: [트랜잭션 - 데이터베이스 개론](https://terms.naver.com/entry.naver?docId=3431266&cid=58430&categoryId=58430&expCategoryId=58430)

트랜잭션은 다음의 다섯가지 상태 중 하나에 속한다.

| 상태                                     | 설명                                                         |
| ---------------------------------------- | ------------------------------------------------------------ |
| 활동 상태(Active)                        | 트랜잭션이 수행되기 시작하여 현재 수행 중인 상태             |
| 부분완료 상태<br />(Partially Committed) | 트랜잭션의 마지막 연산은 끝났지만, 최종 결과를 데이터베이스에 아직 반영하지 않은 상태 |
| 완료 상태(Committed)                     | 트랜잭션이 성공적으로 완료되어 `commit` 연산을 실행한 상태<br />최종 결과를 데이터베이스에 반영 |
| 실패 상태(Failed)                        | 여러 이유(HW/SW 문제, 트랜잭션 내부의 오류)로 인해 장애가 발생하여 트랜잭션의 수행이 중단된 상태 |
| 철회 상태(Aborted)                       | 트랜잭션을 수행하는 데 실패하여 `rollback` 연산을 실행하여 트랜잭션 실행 이전으로 돌아간 상태 |

<br/>

> [!NOTE]
>
> **DBMS에서는 항상 연산(Query)이 수행될 때마다 트랜잭션을 생성한다.**

<br/>

#### 사용이유

트랜잭션은 데이터베이스가 항상 정확하고 일관된 상태를 유지할 수 있도록 보장한다.

또한, 여러 작업을 하나의 "논리적인" 작업 단위로 묶어서 처리할 수 있다.

<br/>

#### 사용방법

`START TRANSACTION`으로 시작하여, 작업 완료 시 `COMMIT`, 실패 시 `ROLLBACK`

##### 트랜잭션 성공

```sql
# 트랜잭션 시작
START TRANSACTION;

# bob의 계좌에서 10만원 차감
UPDATE account
SET balance = balance - 100000
WHERE username = 'bob';

-- steve의 계좌에 10만원 추가
UPDATE account
SET balance = balance + 100000
WHERE username = 'steve';

-- 작업이 모두 성공했으므로 커밋
COMMIT;

-- 변경된 계좌 잔액 확인
SELECT * FROM account;
```

<br/>

<br/>

### 3. NoSQL(Not Only SQL)

#### 정의

NoSQL은 이름 그대로, 기존의 관계형 데이터베이스에서 사용하는 SQL만을 사용하지 않는 여러 유형의 데이터베이스를 뜻한다.

<br/>

#### 알아야하는 이유

현대 데이터 환경에서는 대규모 데이터가 단기간에 생성된다. 또한, 다양한 형태(정형, 반정형, 비정형)의 데이터를 포함한다.

이러한 환경에서 기존의 관계형 데이터베이스 시스템에서는 처리에 한계가 발생했다.

> 따라서, **다양한 데이터 유형**을 유연하게 처리하고, **대규모 데이터**를 효율적으로 관리하며, 시스템의 확장성과 성능을 극대화하기 위해 NoSQL이 대안으로 제시되었다.

<br/>

##### 🔻 NoSQL의 특징

- **수평적 확장성**: 저렴한 비용으로 여러 대의 컴퓨터에 데이터를 분산, 저장, 처리하는 것이 가능하다.
- **`Schemaless`**: 유연한 데이터 모델을 사용하고 스키마 없이 동작한다.
  - 데이터 구조를 미리 정의할 필요가 없고, 수시로 그 구조를 바꿀 수 있어서 **비정형 데이터 저장에 적합**하다.
- **Transaction 미지원**: Eventual Consistency 모델 채택
  - 확장성과 가용성을 우선하는 설계를 따른다.
  - 데이터의 최종적인 일관성은 보장하지만, 실시간으로 무결성을 유지하지는 않는다.

<br/>

#### 동작방식

비관계형 데이터베이스는 **트리 구조 데이터 구성**을 갖기 때문에, 데이터 형태에 따라 세부 종류가 나눠진다.

| 종류                                                       | 설명                                                         |
| ---------------------------------------------------------- | ------------------------------------------------------------ |
| 키-값 저장소<br />(Key-Value Stores)                       | 각 키에 하나의 값이 매핑되는 가장 단순한 형태의 데이터 저장 방식<br />예) Redis |
| 문서 지향 데이터 베이스<br /> (Document Oriented Database) | JSON, XML과 같은 문서 형식을 사용하여 데이터를 저장한다.<br />예) MongoDB, CouchDB |
| 컬럼 기반 데이터베이스<br /> (Column-based Database)       | 컬럼 단위로 데이터를 저장하고 관리하여, 대량의 데이터를 빠르게 조회하고 분석할 수 있다.<br />예) Cassandra |
| 그래프 데이터베이스<br />(Graph Database)                  | 데이터를 노드와 엣지로 표현하여, 객체 간의 관계를 중심으로 데이터를 저장하고 조회한다.<br />예) Neo4j |

<br/>

<br/>

## 오늘의 회고

- 데이터베이스를 사용하기 위해서는 결국 **저장된 데이터를 검색**해야 하는데 이를 빠르게 하기 위해서는 인덱스를 활용해야 한다.
- DBMS에서는 항상 데이터베이스가 정확하고 일관된 상태를 유지하기 위해 다양한 기능을 제공하고, 그 중 하나가 트랜잭션이다.
- 현대의 SNS 등에서 나오는 비정형 데이터와 빅데이터를 관리하기 위해 `NoSQL`을 사용하게 되었다.
  - 기존 RDBMS의 ACID 트랜잭션 모델을 완전히 버리고, BASE 모델을 채택한다.

- 오늘은 몸이 좋지 않아서, 공부 시간이 적었다. 내일은 조금 더 열심히 하는 하루가 되어야겠다.
